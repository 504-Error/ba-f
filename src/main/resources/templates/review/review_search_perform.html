<!DOCTYPE html>
<html
        xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>ba-f : 리뷰 공연 검색</title>
    <link rel="stylesheet" type="text/css" th:href="@{/static/bootstrap.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/static/style.css}">
</head>
<body>
<div  layout:fragment="content" class="container">
    <h5 class="my-3 border-bottom pb-2">공연 정보 검색</h5>

    <div class="review-main-container mt-5">
        <!--        검색창 및 글쓰기 버튼 생성-->
        <div class="review-header-content">
            <form th:action="@{/review/create/search/perform}" method="get" id="searchForm">
                <select class="form-select float-start me-3" th:value="${genre}" name="genre" id="inputGenre" style="width: 17%">
                    <option selected value="0">전체</option>
                    <option value="1">뮤지컬</option>
                    <option value="2">연극</option>
                    <option value="3">클래식</option>
                    <option value="4">오페라</option>
                    <option value="5">무용</option>
                    <option value="6">국악</option>
                    <option value="7">기타</option>
                </select>

                <div id="review-search-input-group">
                    <div class="input-group mb-3 me-sm-3">
                        <input type="text" th:value="${keyword}" name="keyword" id="review-search-review-input" class="form-control" placeholder="공연을 검색해주세요" aria-label="review search" aria-describedby="button-addon2">
                        <button class="btn btn-outline-orange" type="submit" id="review-button-search">검색</button>
                    </div>
                </div>
            </form>

        </div>
    </div>

    <div class="container" style="clear: left">
        <div class="row row-cols-1 row-cols-md-4">
            <div class="col" th:each="performInfo : ${performInfoList}">
                <div class="card review-card">
                    <img th:src="${performInfo.posterUrl}" class="card-img-top" alt="..." height="400px">
                    <div class="card-body">
                        <h6 class="card-title" th:text="${performInfo.title}"></h6>
                        <div class="card-status">
                            <p class="perform-place" th:text="${performInfo.facility}"></p>
                            <p th:text="${performInfo.startDate + ' - ' + performInfo.endDate}"></p>
                        </div>
                        <button type="button" class="btn btn-secondary btn-sm float-end" id="btn-select-perform" th:attr="onclick=|selectPerform(this, ${performInfo})|">선택</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
    <script>
        const genreNum = new URLSearchParams(window.location.search).get("genre");
        console.log("genreNum", genreNum);

        switch (Number(genreNum)) {
            case 0:
                $("#inputGenre").val("0").prop("selected",true);
                break;
            case 1:
                $("#inputGenre").val("1").prop("selected",true);
                break;
            case 2:
                $("#inputGenre").val("2").prop("selected",true);
                break;
            case 3:
                $("#inputGenre").val("3").prop("selected",true);
                break;
            case 4:
                $("#inputGenre").val("4").prop("selected",true);
                break;
            case 5:
                $("#inputGenre").val("5").prop("selected",true);
                break;
            case 6:
                $("#inputGenre").val("6").prop("selected",true);
                break;
            case 7:
                $("#inputGenre").val("7").prop("selected",true);
                break;
            default:
                $("#inputGenre").val("0").prop("selected",true);
        }

        function selectPerform(selectObject, performInfo) {
            console.log("performInfo : ", performInfo);


            // $.ajax({
            //     url: "/bus/station-info",
            //     type: "POST",
            //     data: JSON.stringify(data), // 요청 시 포함되어질 데이터
            //     contentType: 'application/json', //요청 컨텐트 타입
            //     dataType: "json", // 응답 데이터 형식
            //     beforeSend: function (jqXHR, settings) {
            //         var header = $("meta[name='_csrf_header']").attr("content");
            //         var token = $("meta[name='_csrf']").attr("content");
            //         jqXHR.setRequestHeader(header, token);
            //     },
            //     success: function (result) {
            //         stationSearchCB(stationNm, arsId, result);
            //     }
            // });
        }


    </script>

</div>
</body>
</html>